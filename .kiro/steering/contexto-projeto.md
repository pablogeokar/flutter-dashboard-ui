# Contexto do Projeto - Domani Fiscal

## Vis√£o Geral

Sistema de Gest√£o Fiscal desenvolvido em Flutter para a **Domani Fiscal**. Interface profissional com design moderno, tema claro/escuro, sidebar responsiva com densidade otimizada e sistema completo de formul√°rios e dialogs.

## Diretrizes Essenciais

- **Idioma:** Portugu√™s do Brasil (pt-BR) em todo c√≥digo, coment√°rios e interface
- **Nomenclatura:** Fun√ß√µes, vari√°veis e componentes em portugu√™s
- **Branding:** Sempre usar "Domani Fiscal" (nunca "Dashboard UI")
- **Paleta de Cores Atualizada:**
  - **Modo Light:** Destaque `#007BFF`, Fundo `#F5F7FA`, Cards `#FFFFFF`
  - **Modo Dark:** Destaque `#5B9CF8`, Fundo `#121212`, Cards `#1E1E1E`

## Arquitetura Atual (Refatorada - Dezembro 2024)

### üèóÔ∏è Separa√ß√£o de Responsabilidades

```
lib/
‚îú‚îÄ‚îÄ services/                           # üîß ESPEC√çFICOS DO PROJETO
‚îÇ   ‚îú‚îÄ‚îÄ README.md                       # Documenta√ß√£o da arquitetura
‚îÇ   ‚îî‚îÄ‚îÄ dialog/
‚îÇ       ‚îú‚îÄ‚îÄ form_dialog_service.dart    # Servi√ßos espec√≠ficos Domani
‚îÇ       ‚îî‚îÄ‚îÄ domani_dialog_callbacks.dart # Callbacks espec√≠ficos Domani
‚îú‚îÄ‚îÄ widgets/                            # üé® GEN√âRICOS E REUTILIZ√ÅVEIS
‚îÇ   ‚îú‚îÄ‚îÄ README.md (documenta√ß√£o completa)
‚îÇ   ‚îú‚îÄ‚îÄ app_initializer.dart, app_layout.dart, dialog.dart
‚îÇ   ‚îî‚îÄ‚îÄ src/
‚îÇ       ‚îú‚îÄ‚îÄ app_layout/ (app_shell.dart, responsive_drawer.dart, drawer_list_item.dart)
‚îÇ       ‚îú‚îÄ‚îÄ dialog/ (form_dialog.dart, dialog_service.dart, dialog_callbacks.dart)
‚îÇ       ‚îî‚îÄ‚îÄ forms/ (form_components.dart, form_row.dart, form_validators.dart)
‚îú‚îÄ‚îÄ config/sidebar_config.dart          # Usa DomaniDialogCallbacks
‚îú‚îÄ‚îÄ screens/
‚îÇ   ‚îú‚îÄ‚îÄ splash_screen.dart, dashboard_screen.dart
‚îÇ   ‚îî‚îÄ‚îÄ em_construcao_screen.dart, teste_screen.dart
‚îú‚îÄ‚îÄ theme/
‚îÇ   ‚îú‚îÄ‚îÄ theme.dart (paleta completa), theme_manager.dart
‚îÇ   ‚îú‚îÄ‚îÄ animations.dart, dark.dart, light.dart
‚îú‚îÄ‚îÄ assets/ (logo_light.png, logo_dark.png)
‚îî‚îÄ‚îÄ DESIGN_IMPROVEMENTS.md (hist√≥rico completo de melhorias)
```

### üéØ Princ√≠pios da Nova Arquitetura

- **lib/services/** - L√≥gica de neg√≥cio e servi√ßos espec√≠ficos do projeto
- **lib/widgets/** - Componentes visuais 100% reutiliz√°veis (copy-paste ready)
- **lib/screens/** - P√°ginas da aplica√ß√£o que combinam widgets e servi√ßos

## Padr√µes de C√≥digo

### Design System

- **Responsividade:** Use `AppTheme.getResponsive*()` para tamanhos adaptativos
- **Cores:** Sempre usar `AppTheme.primaryLight/primaryDark` para consist√™ncia
- **Anima√ß√µes:** Dura√ß√µes padronizadas (100ms, 200ms, 300ms)
- **Espa√ßamento:** Grid 8px - use `AppTheme.spacing*` (XS=4, S=8, M=16, L=24, XL=32)

### Formul√°rios (OBRIGAT√ìRIO)

- **Alinhamento:** SEMPRE usar `FormRow.top()` ao inv√©s de `Row` manual
- **Propor√ß√µes:** Use `FormRowFlex` para controle de propor√ß√µes (ex: 2:1, 1:2:1)
- **Espa√ßamento:** 16px entre campos, 20px entre se√ß√µes
- **Valida√ß√£o:** Implementar em todos os campos obrigat√≥rios

### Dialogs (OBRIGAT√ìRIO - Arquitetura Refatorada)

#### üîß Para Funcionalidades Espec√≠ficas do Projeto:

- **Servi√ßos:** Use `FormDialogService.mostrar*()` (lib/services/dialog/)
- **Callbacks:** Use `DomaniDialogCallbacks.*()` (lib/services/dialog/)
- **Import:** `import '../../services/dialog/form_dialog_service.dart';`

#### üé® Para Widgets Gen√©ricos (Reutiliz√°veis):

- **Servi√ßos:** Use `DialogService.show*()` (lib/widgets/src/dialog/)
- **Callbacks:** Use `DialogCallbacks.show*()` (lib/widgets/src/dialog/)
- **Import:** `import 'widgets/src/dialog/dialog_service.dart';`

- **Tamanhos:** Pequeno=400px, M√©dio=600px, Grande=700px, XL=800px+
- **Scroll:** Autom√°tico para formul√°rios longos
- **√çcones:** Sempre incluir √≠cone apropriado no header

## Estado Atual

### ‚úÖ Implementado e Funcional

- **Interface:** Splash screen, dashboard com m√©tricas, navega√ß√£o completa
- **Temas:** Claro/escuro com paleta profissional refinada
- **Sidebar:** Responsiva, densidade otimizada, indicador de item ativo elegante
- **Formul√°rios:** Sistema FormRow com alinhamento perfeito
- **Dialogs:** Sistema completo com scroll autom√°tico e valida√ß√£o
- **Documenta√ß√£o:** Completa e profissional (README.md em cada m√≥dulo)

### üîß Caracter√≠sticas T√©cnicas

- **Performance:** Otimizada, sem travamentos
- **Responsividade:** Breakpoints inteligentes para diferentes telas
- **Acessibilidade:** Cursor apropriado, feedback visual, navega√ß√£o por teclado
- **UX:** Anima√ß√µes suaves (200ms), estados de hover, indicadores visuais

### üöß Em Desenvolvimento

- Telas espec√≠ficas (usam EmConstrucaoPlaceholder com preview de funcionalidades)
- Integra√ß√µes com APIs fiscais
- Relat√≥rios avan√ßados com gr√°ficos

## Widgets Essenciais do Sistema

### FormRow (SEMPRE usar para formul√°rios)

```dart
// Distribui√ß√£o igual
FormRow.top(
  children: [
    DomaniTextField(label: 'Email'),
    DomaniTextField(label: 'Telefone'),
  ],
)

// Propor√ß√µes customizadas
FormRowFlex.top(
  items: [
    FormRowItem(flex: 2, child: DomaniTextField(label: 'Endere√ßo')),
    FormRowItem(flex: 1, child: DomaniTextField(label: 'N√∫mero')),
  ],
)
```

### Dialogs - Exemplos de Uso

#### üîß Espec√≠ficos do Projeto (FormDialogService)

```dart
// Import correto
import '../../services/dialog/form_dialog_service.dart';

// Cadastros pr√©-configurados
FormDialogService.mostrarCadastroCliente(
  context: context,
  onConfirmar: () => _salvarCliente(),
);

// Dialog customizado
FormDialogService.mostrarFormulario(
  context: context,
  titulo: 'Meu Dialog',
  icone: Icons.edit,
  formulario: _buildFormulario(),
  onConfirmar: () => _processar(),
);
```

#### üé® Gen√©ricos Reutiliz√°veis (DialogService)

```dart
// Import correto
import 'widgets/src/dialog/dialog_service.dart';

// Dialog gen√©rico
DialogService.showFormDialog(
  context: context,
  title: 'Generic Dialog',
  form: MyFormWidget(),
  onConfirm: () => _save(),
);

// Callback gen√©rico para menus
DialogCallbacks.showFormCallback(
  context: context,
  title: 'Add Item',
  form: ItemFormWidget(),
  onConfirm: () => _saveItem(),
  successMessage: 'Item saved!',
);
```

#### üîó Callbacks para Sidebar (DomaniDialogCallbacks)

```dart
// Import correto
import '../services/dialog/domani_dialog_callbacks.dart';

// Uso na sidebar
DrawerItem(
  title: 'Clientes',
  onDialogTap: DomaniDialogCallbacks.cadastroCliente(context),
);
```

## Melhorias Implementadas (Dezembro 2024)

### üé® Design Profissional

- **Nova paleta de cores** seguindo especifica√ß√µes de design moderno
- **Cards com profundidade adequada** - sombras sutis no light, bordas no dark
- **Tipografia hier√°rquica** - t√≠tulos bold, texto normal, detalhes smaller
- **Espa√ßamento ultra-compacto** na sidebar para m√°ximo aproveitamento

### üîß Sistema de Formul√°rios

- **FormRow** - Alinhamento autom√°tico perfeito
- **FormRowFlex** - Controle de propor√ß√µes (2:1, 1:2:1, etc.)
- **Valida√ß√£o integrada** - Campos obrigat√≥rios e formatos
- **Responsividade** - Adapta-se a diferentes tamanhos

### üí¨ Sistema de Dialogs

- **FormDialog** - Widget base reutiliz√°vel
- **FormDialogService** - Servi√ßos pr√©-configurados
- **Scroll autom√°tico** - Formul√°rios longos funcionam perfeitamente
- **Anima√ß√µes suaves** - Entrada/sa√≠da com scale + fade

### üéØ UX Aprimorada

- **Cursor inteligente** - Pointer em √°reas clic√°veis
- **Indicador de item ativo** - Linha vertical de 4px elegante
- **Estados de hover** - Feedback visual profissional
- **Divisores entre grupos** - Organiza√ß√£o visual na sidebar

## Documenta√ß√£o e Manutenibilidade

### üìö Sistema de Documenta√ß√£o

- **README.md principal** - Vis√£o geral completa
- **README.md por m√≥dulo** - Documenta√ß√£o espec√≠fica
- **C√≥digo autodocumentado** - Coment√°rios detalhados
- **Exemplos pr√°ticos** - Copy-paste ready

### üèóÔ∏è Arquitetura Limpa

- **Separa√ß√£o de responsabilidades** - Cada widget tem prop√≥sito claro
- **Reutiliza√ß√£o m√°xima** - Widgets gen√©ricos e espec√≠ficos
- **Padr√µes consistentes** - Estrutura uniforme
- **Escalabilidade** - Base s√≥lida para crescimento

## Pr√≥ximas Implementa√ß√µes

1. **Tabelas de dados** - Sistema de DataTable responsivo
2. **Gr√°ficos fiscais** - Charts para m√©tricas e relat√≥rios
3. **Sistema de notifica√ß√µes** - Alerts e toasts padronizados
4. **Upload de arquivos** - Drag & drop para documentos
5. **Calend√°rio fiscal** - Componente de agenda integrado
6. **APIs fiscais** - Integra√ß√µes com servi√ßos externos

## Troubleshooting Comum

### Formul√°rios Desalinhados

‚ùå **N√£o fa√ßa:** `Row(children: [Expanded(...), Expanded(...)])`
‚úÖ **Fa√ßa:** `FormRow.top(children: [...])`

### Dialogs Quebrados

‚ùå **N√£o fa√ßa:** `showDialog` manual
‚úÖ **Fa√ßa:** `FormDialogService.mostrarFormulario()`

### Cores Inconsistentes

‚ùå **N√£o fa√ßa:** `Color(0xFF...)`
‚úÖ **Fa√ßa:** `Theme.of(context).colorScheme.primary`

### Performance Lenta

‚ùå **N√£o fa√ßa:** Widgets sem `const`
‚úÖ **Fa√ßa:** `const DomaniTextField(...)` quando poss√≠vel

---

**√öltima atualiza√ß√£o:** Dezembro 2024  
**Status:** Produ√ß√£o - Sistema est√°vel e documentado  
**Pr√≥xima revis√£o:** Ap√≥s implementa√ß√£o de tabelas e gr√°ficos

## Arquitetura Reorganizada (Dezembro 2024)

### üèóÔ∏è Separa√ß√£o de Responsabilidades

- **lib/services/** - SERVI√áOS (l√≥gica de neg√≥cio, APIs, utilit√°rios)
- **lib/widgets/** - WIDGETS (componentes visuais reutiliz√°veis)
- **lib/screens/** - TELAS (p√°ginas da aplica√ß√£o)

### üìÅ Estrutura de Servi√ßos

```
lib/services/
‚îî‚îÄ‚îÄ dialog/
    ‚îî‚îÄ‚îÄ form_dialog_service.dart  # Servi√ßos de dialog (n√£o √© widget!)
```

### üéØ Import Correto para FormDialogService

```dart
// CORRETO - servi√ßo est√° em lib/services/
import '../../services/dialog/form_dialog_service.dart';

// INCORRETO - n√£o est√° mais em widgets
import '../widgets/src/dialog/form_dialog_service.dart';
```

### ‚úÖ Benef√≠cios da Nova Arquitetura

- **Widgets desacoplados** - N√£o dependem de servi√ßos espec√≠ficos
- **Servi√ßos organizados** - L√≥gica de neg√≥cio centralizada
- **Manutenibilidade** - Mudan√ßas em servi√ßos n√£o afetam widgets
- **Escalabilidade** - F√°cil adicionar novos servi√ßos
- **Testabilidade** - Servi√ßos podem ser testados independentemente

## üöÄ Refatora√ß√£o Arquitetural Completa (Dezembro 2024)

### ‚úÖ **Widgets 100% Reutiliz√°veis Implementados**

A maior refatora√ß√£o do projeto foi conclu√≠da com sucesso, separando completamente:

#### üé® **lib/widgets/** - Gen√©ricos e Reutiliz√°veis

- **Objetivo:** Widgets que podem ser copiados para qualquer projeto Flutter
- **Caracter√≠sticas:** Zero depend√™ncias espec√≠ficas do projeto
- **Status:** Copy-paste ready - funcionam imediatamente em novos projetos
- **Documenta√ß√£o:** README.md + EXAMPLE_USAGE.md com exemplos completos

#### üîß **lib/services/** - Espec√≠ficos do Domani Fiscal

- **Objetivo:** L√≥gica de neg√≥cio e funcionalidades espec√≠ficas do projeto
- **Caracter√≠sticas:** Formul√°rios personalizados, valida√ß√µes espec√≠ficas
- **Status:** Integra√ß√£o perfeita com widgets gen√©ricos
- **Documenta√ß√£o:** README.md com arquitetura completa

### üîÑ **Migra√ß√£o de Imports Realizada**

#### ‚ùå **Imports Antigos (Removidos)**

```dart
// INCORRETO - n√£o funciona mais
import '../widgets/src/dialog/form_dialog_service.dart';
```

#### ‚úÖ **Imports Corretos (Atuais)**

```dart
// Para funcionalidades espec√≠ficas do projeto
import '../../services/dialog/form_dialog_service.dart';
import '../../services/dialog/domani_dialog_callbacks.dart';

// Para widgets gen√©ricos reutiliz√°veis
import 'widgets/src/dialog/dialog_service.dart';
import 'widgets/src/dialog/dialog_callbacks.dart';
```

### üìã **Checklist de Uso**

#### Para Desenvolvedores do Domani Fiscal:

- ‚úÖ Use `FormDialogService` para dialogs espec√≠ficos (cliente, fornecedor, etc.)
- ‚úÖ Use `DomaniDialogCallbacks` na sidebar e menus
- ‚úÖ Imports corretos: `lib/services/dialog/`

#### Para Novos Projetos:

- ‚úÖ Copie apenas `lib/widgets/` para o novo projeto
- ‚úÖ Use `DialogService` e `DialogCallbacks` gen√©ricos
- ‚úÖ Consulte `EXAMPLE_USAGE.md` para exemplos pr√°ticos
- ‚úÖ Customize conforme necess√°rio sem quebrar funcionalidade

### üéØ **Vantagens Alcan√ßadas**

1. **üîÑ Reutiliza√ß√£o Total:** Widgets funcionam em qualquer projeto Flutter
2. **üèóÔ∏è Arquitetura Limpa:** Separa√ß√£o clara entre gen√©rico e espec√≠fico
3. **üìñ Documenta√ß√£o Completa:** Exemplos pr√°ticos e guias detalhados
4. **üöÄ Produtividade:** Desenvolvimento mais r√°pido em novos projetos
5. **üîß Manutenibilidade:** Mudan√ßas isoladas n√£o afetam outros m√≥dulos
6. **‚úÖ Qualidade:** Zero problemas no flutter analyze

### üìö **Documenta√ß√£o Criada**

1. **lib/services/README.md** - Arquitetura de servi√ßos
2. **lib/widgets/src/dialog/README.md** - Widgets gen√©ricos
3. **lib/widgets/src/dialog/EXAMPLE_USAGE.md** - Exemplo completo de uso
4. **Contexto atualizado** - Este arquivo com todas as mudan√ßas

---

**Refatora√ß√£o conclu√≠da:** Dezembro 2024  
**Status:** ‚úÖ Implementado e testado  
**Pr√≥ximo passo:** Aplicar mesmo padr√£o para forms, layouts e outros widgets
